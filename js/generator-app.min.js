(function(){"use strict";var n=angular.module("GameGeneratorApp",["cosmicAliens","ngStorage","ui.select"]);n.constant("generatorVersion",2);n.controller("GeneratorCtrl",["$scope","alienData","$localStorage","$sessionStorage","generatorVersion",function(n,t,i,r,u){var f=this,a={complexities:[!0,!0,!0],games:{E:!0},namesExcluded:[],setupLevel:"none",numToChoose:2,preventConflicts:!0,version:1},c;i.$default(a);(!i.version||i.version<u)&&(i.$reset(a),i.version=u);n.settings=i;n.complexities=i.complexities;n.namesExcluded=i.namesExcluded;n.setupLevel=i.setupLevel;n.numToChoose=i.numToChoose;n.message="Loading aliens...";n.aliensToShow=[];n.aliensAll=[];var e=[],h=[],s=[],o=[];n.namesAll=[];n.numOut=function(){return e.length+h.length+s.length};n.numCurrent=function(){return e.length};n.numGiven=function(){return h.length};n.numRestricted=function(){return s.length};n.numLeft=function(){return o.length};n.aliens;c=function(){var i=n.settings;o=n.namesAll.filter(function(r){var u=t.get(r);return i.complexities[u.level]&&i.games[u.game]&&n.namesExcluded.indexOf(r)<0&&(n.setupLevel==="none"||u.setup===undefined||n.setupLevel==="color"&&u.setup!=="color")});h=[];e=[];s=[];f.restrictNumToChoose();n.message="List reset.";n.aliensToShow=[]};f.onExcludeSelect=function(t){n.namesExcluded.indexOf(t.name)<0&&(n.namesExcluded.push(t.name),n.excluded.push(t));f.saveSetting("namesExcluded")};f.onExcludeRemove=function(t){var i=n.namesExcluded.indexOf(t.name);i>-1&&(n.namesExcluded.splice(i,1),n.excluded.splice(i,1));f.saveSetting("namesExcluded")};f.saveSetting=function(t){i[t]=n[t];c()};var p=function(){var c=Math.floor(Math.random()*o.length),i,u,f,r,h;if(o[c]){if(i=o.splice(c,1)[0],e.push(i),e.sort(),u=t.get(i),n.settings.preventConflicts&&u.restriction)for(f=u.restriction.split(","),r=0;r<f.length;r++)h=o.indexOf(f[r]),h>-1&&s.push(o.splice(h,1)[0]);return i}},v=function(){h=h.concat(e,s).sort();s=[];e=[]},y=function(){o=o.concat(e,s);o.sort();e=[];s=[]},l=0;f.reset=function(){confirm("Reset list of aliens?")?c():l++;l>2&&(v(),n.message="Aliens given out so far:",n.aliensToShow=h.map(t.get),l=0)};f.restrictNumToChoose=function(){var t=n.numToChoose,r=n.numLeft();r>0&&t>r&&(t=r);t<1&&(t=1);n.numToChoose=t;i.numToChoose=t};f.pickAliens=function(){var i,r,u;for(v(),i=n.numToChoose,r=0;r<i;r++)if(u=p(),!u)break;if(e.length<i){y();n.aliensToShow=[];n.message="Not enough potential aliens left."+(n.settings.preventConflicts?' It\'s possible that the "Prevent conflicts" option is preventing me from displaying remaining aliens.':"");return}n.message="Choices:";n.aliensToShow=e.map(t.get);f.restrictNumToChoose();return};f.hide=function(){n.aliensToShow=[];n.message="Choices hidden."};f.show=function(){var i=e.map(function(n){return n[0].toLowerCase()});if(i.indexOf((prompt("Enter the first initial of one of the aliens you were given, then click OK.")||"").toLowerCase())<0){n.message="Wrong letter.";return}n.message="Choices:";n.aliensToShow=e.map(t.get)};f.redo=function(){confirm("Redo?")&&(y(),f.pickAliens())};t.onLoaded(function(){n.namesAll=n.namesAll.concat(t.getNames().sort());n.aliensAll=n.namesAll.map(function(n){return t.get(n)});n.excluded=n.aliensAll.filter(function(t){return n.namesExcluded.indexOf(t.name)>-1});c()})}])})();
//# sourceMappingURL=generator-app.min.js.map
