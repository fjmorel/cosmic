"use strict";function setState(n,t,i,r,u){n!==undefined&&(btnHide.textContent=n?"Show":"Hide");i!==undefined&&(btnHide.disabled=i);t!==undefined&&(btnChoose.disabled=t);r!==undefined&&(btnRedo.disabled=r);u!==undefined&&(btnReset.disabled=u)}function resetGenerator(){console.log("Reset");DATA.reset(SETTINGS);setState(!1,!0,!0,!0,!0);SETTINGS.resetHowManyToSelect();OUTPUT.message("List reset.");OUTPUT.status()}var NOT_RESET=0,nNumber,btnChoose,btnReset,btnHide,btnRedo,DATA=function(){var n=[],e=[],t=[],r=[],i=[],u=[],f={};return{init:function(n){n.forEach(function(n){u.push(n.name);f[n.name]=n});u.sort()},getNames:function(){return u?u.slice(0):[]},getByName:function(n){return f[n]},exclude:function(n){e=n.slice(0).sort()},getExcludedNames:function(){return e.slice(0)},getGivenNames:function(){return r.slice(0)},getSelectedNames:function(){return t.slice(0)},select:function(r){var c=Math.floor(Math.random()*n.length),u,o,s,e,h;if(n[c]){if(u=n.splice(c,1)[0],t.push(u),t.sort(),o=f[u],r&&o.restriction)for(s=o.restriction.split(","),e=0;e<s.length;e++)h=n.indexOf(s[e]),h>-1&&i.push(n.splice(h,1)[0]);return u}},undo:function(){n=n.concat(t,i);n.sort();t=[];i=[]},next:function(){r=r.concat(t,i).sort();i=[];t=[]},getOutOfPoolSize:function(){return t.length+r.length+i.length},getPoolSize:function(){return n.length},reset:function(o){n=u.filter(function(n){var t=f[n];return o.isComplexity(t.level)&&o.isGame(t.game)&&!(e.indexOf(t.name)>-1)&&(o.getSetupAllowed()===0||t.setup===undefined||o.getSetupAllowed()===1&&t.setup!=="color")});r=[];t=[];i=[]}}}(window),SETTINGS=function(n,t){var r=window.localStorage,e=[!0,!0,!0],h=["Green","Yellow","Red"],u={E:!0},o=!0,i=2,s=0,f=function(n,t){r&&(typeof t!="string"&&(t=JSON.stringify(t)),r.setItem(n,t))};return{load:function(){var n,f;if(r)try{if(n=JSON.parse(r.games),n&&(u=n,Object.keys(u).forEach(function(n){document.getElementById("game"+n).checked=u[n]})),n=JSON.parse(r.levels),n)for(e=n,f=0;f<h.length;f++)document.getElementById(h[f]).checked=e[f];n=r.choose;n&&(i=n,document.getElementById("choose").value=i);n=r.preventConflict;n!==undefined&&n!==null&&(o=n=="true",document.getElementById("preventConflict").checked=o);n=JSON.parse(r.exclude);n&&t.exclude(n);n=r.setup;n&&(s=parseInt(n,10),$("#setup"+s).trigger("click"))}catch(c){r.clear();OUTPUT.message("Could not load settings. Resetting to defaults.")}},exclude:function(n){f("exclude",n)},isGame:function(n){return u[n]},setGame:function(n,t){u[n]=t;f("games",u)},isComplexity:function(n){return e[n]},setComplexity:function(n,t){e[h.indexOf(n)]=t;f("levels",e)},restrictConflicts:function(n){return n!==undefined&&(o=n,f("preventConflict",o)),o},setSetupAllowed:function(n){s=n;f("setup",s)},getSetupAllowed:function(){return s},howManyToGive:function(){return i},resetHowManyToSelect:function(n){n&&(i=n);var r=t.getPoolSize();return r>0&&i>r&&(i=r),i<1&&(i=1),f("choose",i),nNumber.value=i,setState(undefined,r<i,undefined,undefined,undefined),i}}}(window,DATA),OUTPUT=function(n,t){function u(n){var t=r[n.level];return'<div class="panel panel-'+t+'"><div class="panel-heading">'+n.name+" "+f(n)+'<span class="clearfix"><\/span><\/div><div class="panel-body"><a href="#" class="pull-right btn btn-sm btn-'+t+'">+<\/a>'+n.power+'<\/div><div class="panel-footer" style="display:none;">'+n.description+"<\/div><\/div>"}function f(n){for(var f,t=r[n.level],i=' <span class="pull-right label label-'+t+'">',u=0;u<=n.level;u++)i+="★";return i+="<\/span>",f=n.setup||n.restriction?'<span class="pull-right label label-'+t+'">!<\/span>':"",'<span class="pull-right label label-'+t+'">C'+n.game.slice(0,1)+"<\/span>"+i+f}var i=document.getElementById("output"),e=document.getElementById("numbers"),r={2:"danger",1:"warning",0:"success"};return{message:function(n){NOT_RESET=0;i.innerHTML='<div class="col-sm-offset-1 col-md-offset-2 col-sm-10 col-md-8">'+n+"<\/div>"},aliens:function(n,r){var e=n.map(t.getByName),o=Math.ceil(e.length/2),f="";r&&(f+='<p class="col-sm-offset-1 col-md-offset-2 col-sm-10 col-md-8">'+r+'<\/p><\/div><div class="row">');f+='<div class="col-sm-offset-1 col-md-offset-2 col-sm-5 col-md-4">'+e.slice(0,o).map(function(n){return u(n)}).join("")+"<\/div>";f+='<div class="col-sm-5 col-md-4">'+e.slice(o).map(function(n){return u(n)}).join("")+"<\/div>";i.innerHTML=f;NOT_RESET=0},status:function(){var n=t.getOutOfPoolSize();e.textContent=n+" of "+(n+t.getPoolSize())+" aliens picked."},excludeOption:function(n){if(!n.id)return n.text;var i=n.text;return $(f(t.getByName(i))+'<span class="alien-name">'+i+"<\/span>")}}}(window,DATA);$(function(){nNumber=$("#choose").on("change",function(){SETTINGS.resetHowManyToSelect(this.value)})[0];$("#Complexities").on("click","input",function(){SETTINGS.setComplexity(this.id,this.checked);resetGenerator()});$("#Games").on("click","input",function(){SETTINGS.setGame(this.id[4],this.checked);resetGenerator()});$("input[type=radio][name=excludeSetup]").on("change",function(){SETTINGS.setSetupAllowed(parseInt(this.value,10));resetGenerator()});$("#preventConflict").on("click",function(){SETTINGS.restrictConflicts(this.checked)});btnReset=$("#reset").on("click",function(){confirm("Reset list of aliens?")?resetGenerator():NOT_RESET++;NOT_RESET>2&&(DATA.next(),OUTPUT.aliens(DATA.getGivenNames(),"Aliens given out so far:"),setState(!1,undefined,!1,!0,undefined))})[0];btnHide=$("#hide").on("click",function(){var n=DATA.getSelectedNames(),t;if(btnHide.textContent==="Hide"){setState(n.length>0,undefined,!(n.length>0),!0,undefined);OUTPUT.message("Choices hidden.");return}if(t=n.map(function(n){return n[0].toLowerCase()}),t.indexOf((prompt("Enter the first initial of one of the aliens you were given, then click OK.")||"").toLowerCase())<0){OUTPUT.message("Wrong letter.");return}OUTPUT.aliens(n);setState(!1,undefined,undefined,!1,undefined)})[0];btnChoose=$("#newAliens").on("click",function(){var n,t,r,i;for(DATA.next(),n=SETTINGS.howManyToGive(),t=0;t<n;t++)if(r=DATA.select(SETTINGS.restrictConflicts()),!r)break;if(i=DATA.getSelectedNames(),i.length<n){DATA.undo();OUTPUT.message("Not enough potential aliens left."+(SETTINGS.restrictConflicts()?' It\'s possible that the "Prevent conflicts" option is preventing me from displaying remaining aliens.':""));setState(undefined,!0,!0,undefined,undefined);return}OUTPUT.status();OUTPUT.aliens(i);setState(!1,undefined,!1,!1,!1);SETTINGS.resetHowManyToSelect();return})[0];btnRedo=$("#redo").on("click",function(){confirm("Redo?")&&(DATA.undo(),$(btnChoose).trigger("click"))})[0];$("#output").on("click","a",function(n){var t=$(this);return t.text(t.text()==="+"?"-":"+").parent().next().toggle(),n.preventDefault(),!1});$.getJSON("data/aliens.json").done(function(n){DATA.init(n);SETTINGS.load();$("#exclude").append(DATA.getNames().map(function(n){return new Option(n,n)})).val(DATA.getExcludedNames()).on("change",function(){var n=$(this).val()||[];DATA.exclude(n);SETTINGS.exclude(n);resetGenerator()}).select2({placeholder:"None selected",templateResult:OUTPUT.excludeOption});resetGenerator()}).fail(function(){OUTPUT.message("Unable to load data. Refresh to try again.")})});
//# sourceMappingURL=generator.min.js.map
